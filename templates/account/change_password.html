{% extends "base.html" %}
{% block title %}Change Password{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="h4 mb-3">Change Password</h1>

  <div class="card shadow-sm">
    <div class="card-body">
      <form method="post"
            action="{{ url_for('account.change_password_self') }}"
            novalidate
            data-password-policy="1"
            data-minlen="10"
            data-commons="123,qwerty,abcd,xyz,password,aiims"
            data-allowed-specials="@#!&">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label" for="current_password">Current password</label>
            <input class="form-control" id="current_password" name="current_password"
                   type="password" required autocomplete="current-password">
          </div>
          <div class="col-md-6">
            <label class="form-label" for="new_password">New password</label>
            <input class="form-control" id="new_password" name="new_password"
                   type="password" required minlength="10" pattern="[A-Za-z0-9@#!&]+"
                   title="Use only letters, digits, and @ # ! &; must include uppercase, lowercase, and one of @ # ! &."
                   autocomplete="new-password">
          </div>
          <div class="col-md-6">
            <label class="form-label" for="confirm_password">Confirm new password</label>
            <input class="form-control" id="confirm_password" name="confirm_password"
                   type="password" required minlength="10" pattern="[A-Za-z0-9@#!&]+"
                   autocomplete="new-password">
          </div>
        </div>

        <div class="mt-3">
          <button class="btn btn-primary" type="submit">Change password</button>
          <a class="btn btn-outline-secondary" href="{{ url_for('account.profile') }}">Back to profile</a>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}



{% block page_scripts %}
<script src="{{ url_for('static', filename='js/password-policy.js') }}?v={{ v }}" defer></script>
{% endblock %}


